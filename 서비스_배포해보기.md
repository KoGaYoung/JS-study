```
서비스를 배포하고싶지만 배포를 (내가) 하고싶진 않았다..TT
// 프론트앤드만 하고싶어..하지만 그럴 수 없음을 체념하기로 했다.
이 글은 개발만 좋아하는 AWS 문외환이 읽고 서비스를 배포할 때 참고하면 좋은글이다!

무료 서버 2대를 제공하는 오라클 클라우드 프리티어에 회원가입의 실패로 AWS를 활용했다.
나는 JS에 익숙하기 때문에 Node.JS(express) + FrontEnd 로 개발할 계획이다.
모든 단계를 요약하면 아래와 같다.
```

## Step
~~~
1. AWS 계정 생성
2. EC2 인스턴스 생성
3. 보안 그룹 설정
4. IAM 설정
5. SSH 접속해서 BackEnd, FrontEnd 서버 배포
6. 깃액션 연동 (생략 가능 하지만 강력추천)
7. DNS 등록
~~~

## 완성된 나의 서비스 화면
// img

---


###  1. AWS 계정 생성
~~~
자 계정을 생성했다면(축하해요!), 로그인 후 EC2 생성하기를 눌러줍니다.
~~~

<img width="600" alt="image" src="img/aws_hompage.png">

### 2. EC2 인스턴스 생성
~~~
프론트앤드, 백앤드 서버를 아마존 클라우드에 배포하기 위해서는 EC2 인스턴스를 생성해야해요.
EC2는 Elastic Compute Cloud 의 줄임말로, 
말 그대로 아마존에서 제공하는 클라우드에요.

몇 가지 설정이 필요한데 차례대로 따라가봅시다. (각 설정별 설명도 해드릴께요)
~~~

<img width="600" alt="image" src="img/ec2_1.png">

~~~
이름을 입력해줍니다. (ex. wait_bucket)

서비스의 구조, 트래픽, 성능 요구사항 등 필요에 따라 인스턴스 갯수를 늘려줘야해요.
저의 경우에는 트래픽이 많은 서비스는 아니라고 생각해서
wait_bucket EC2 단일 인스턴스에 프론트앤드, 백앤드를 둘 다 배포하려고해요. 

단일 인스턴스: 비용 저렴, 관리포인트 감소의 이유
보통의 서비스에서는 DB인스턴스, 백앤드 인스턴스, 프론트앤드 인스턴스로 분리해서 관리합니다.
(보안과 확장에 용이해요, 단점은 비용과 관리포인트)

AMI (아마존 머신 이미지) 선택
AMI는 EC2 인스턴스를 생성하기 위한 초기설정 모음들이다.
종류는 AWS Linux, 리눅스, 우분투 등이 있습니다.

AWS Linux: 리눅스 기반 운영체재. 보안과 성능이 AWS에 최적화 되어있음
macOS: 애플 운영체제, Mac 전용 서비스인 경우 사용
리눅스: 리눅스 운영체제. 

저의 경우에는 백앤드, 프론트앤드를 둘 다 올릴꺼기 때문에 AWS Linux와 리눅스 둘 중 하나를 고민했는데요.
일단 리눅스는 조금이나마 접해봐서 좀 더 익숙하고, 소프트웨어 호환성이 높기때문에 (둘 다 배포하니까요..
리눅스를 선택했습니다.
~~~

<img width="600" alt="image" src="img/ec2_2.png">

~~~
프리티어(무료)를 이용하고 있기 때문에 인스턴스 유형은 t2.micro를 선택해줍니다.
~~~

<img width="600" alt="image" src="img/ec2_3.png">
<img width="600" alt="image" src="img/ec2_4.png">

~~~
키-페어를 선택하거나 새로 만들어줍니다. 
만들어진 파일은 잘 저장해주세요. (중요해요!)
또한 파일은 보안상 외부에 노출되어서는 안됩니다.
이후 ssh 서버 접속, 깃 액션 연동에 (파일 내용이) 활용됩니다!

키-페어 이름은 아무거나 상관없습니다.
RSA 암호화를 선택해주고 파일은 ssh를 통해 접속할꺼기때문에 .pem 확장자로 선택합니다.
~~~

<img width="600" alt="image" src="img/ec2_5.png">

~~~
네트워크 설정의 경우 기존 보안 그룹이 있다면 선택,
없다면 사진과 같은 기본설정으로 만들어줍니다.
(밑에서 보안그룹 만들꺼라 지금은 패스!)
~~~

<img width="600" alt="image" src="img/ec2_6.png">

~~~
스토리지의 용량을 30기가 내에서 설정할 수 있습니다.
저는 처음에 잘 몰라서 8기가로 설정했는데요.. 
이후에 서버에서 빌드, 배포하면서 CPU 100치고 서버가 힘들어하더라구요.....TT
16기가를 추천합니다.
(용량이 커지면 나중에 유료로 전환할 경우 더 많은 요금이 나옵니다.)

그리고 인스턴스 시작을 눌러주면 인스턴스 생성 완료입니다
~~~

~~~
<img width="600" alt="image" src="img/ec2_7.png">
~~~

## 3. 보안 그룹 설정
~~~
보안그룹 페이지로 넘어와요.
아까 기본 설정으로 만들어둔 default 보안 그룹이 보입니다.
하지만 저는 default보다 예쁜 이름으로 보안그룹을 만들고 싶어서 (ㅋㅋㅋ중요) 
launch-wizard-1 이름으로 하나 생성해주었습니다.
~~~

<img width="600" alt="image" src="img/aws_security_1.png">

~~~
SSH(22번 포트), HTTP(80번 포트), HTTPS(443번 포트)에 대한 규칙을 설정해요

네트워크 트래픽 흐름을 제어하는 규칙인 인바운드, 아웃바운드 규칙을 설정합니다.
인바운드: 외부에서 내부로 들어오는 트래픽 관리 
(= 인터넷에서 서버로 접근하는 요청을 제어)
아웃바운드: 네트워크에서 외부로 나가는 트래픽을 관리 
(= 서버가 인터넷의 다른 서버에 데이터를 보내거나 요청을 하는 경우 이를 제어)

SSH -> 우리가 서버에 접속해서 명령어를 실행하기 위한 포트
HTTP, HTTPS -> 웹 페이지를 요청하고 전송하는 데 사용
사용자 지정 TCP -> 서버(ex. 8000번 포트) 프론트(ex. 3000번 포트)에 띄우기 위함

보안그룹 생성을 눌러서 그룹을 생성해줘요!
~~~

<img width="600" alt="image" src="img/aws_security_3.png">
<img width="600" alt="image" src="img/aws_security_4.png">
<img width="600" alt="image" src="img/aws_security_5.png">


~~~
그리고 EC2 > 작업 > 보안 > 보안그룹 설정으로 와서 보안그룹을 만들어둔 launch_wizard-1로 변경해줍니다.
~~~

<img width="600" alt="image" src="img/aws_security_6.png">

## 4. IAM 설정


## 5. SSH 접속해서 BackEnd, FrontEnd 서버 배포

<img width="600" alt="image" src="img/aws_server_1.png">
<img width="600" alt="image" src="img/aws_server_2.png">

~~~
터미널에서 다음 명령어를 사용하여 인스턴스에 접속
ssh -i /path/to/${your-key-name}.pem {AMI}@${your-instance-public-dns}

저의 경우에는  bucketServerTest 라는 이름으로 키를 만들었고,
AMI는 ubuntu를 사용헀고, 인스턴스의 public dns를 복사해서 명령어를 만들어줍니다.
~~~

~~~
키 페어 파일의 권한 설정
키 파일을 읽기 전용으로 설정하여 현재 사용자만 키에 액세스할 수 있도록 
 저장된 디렉토리로 이동
 chmod 400 /path/to/your-key-name.pem
~~~
~~~
터미널에서 다음 명령어를 사용하여 인스턴스에 접속
ssh -i /path/to/your-key-name.pem ubuntu@your-instance-public-dns

~~~